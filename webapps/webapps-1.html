

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Django の環境構築 &mdash; Python School 1.5.2 documentation</title>
    
    <link rel="stylesheet" href="../static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="../static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/print.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.5.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../static/jquery.js"></script>
    <script type="text/javascript" src="../static/underscore.js"></script>
    <script type="text/javascript" src="../static/doctools.js"></script>
    <script type="text/javascript" src="../_static/theme_extras.js"></script>
    <link rel="top" title="Python School 1.5.2 documentation" href="../index.html" />
    <link rel="up" title="Webアプリケーションの実装" href="index.html" />
    <link rel="next" title="アプリケーションの作成" href="webapps-2.html" />
    <link rel="prev" title="Webアプリケーションの実装" href="index.html" /> 
  </head>
  <body>
      <div class="header"><h1 class="heading"><a href="../index.html">
          <span>Python School 1.5.2 documentation</span></a></h1>
        <h2 class="heading"><span>Django の環境構築</span></h2>
      </div>
      <div class="topnav">
      
        <p>
        «&#160;&#160;<a href="index.html">Webアプリケーションの実装</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="../index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="webapps-2.html">アプリケーションの作成</a>&#160;&#160;»
        </p>

      </div>
      <div class="content">
        
        
  <div class="section" id="django">
<h1>Django の環境構築<a class="headerlink" href="#django" title="Permalink to this headline">¶</a></h1>
<div class="section" id="id1">
<h2>モジュールをインストールする<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p><strong class="command">virtualenv</strong> を使って専用環境を作成します。
ちょっとしたツールを Web アプリケーションとして実装してみますので、
<em>webapp-tools</em> としておきましょう。</p>
<div class="highlight-python"><pre>&gt; D:
&gt; cd D:\sandbox
&gt; C:\Python27\Scripts\virtualenv.exe --distribute webapp-tools</pre>
</div>
<p><cite>webapp-tools</cite> フォルダに <tt class="file docutils literal"><span class="pre">requirements.txt</span></tt> を作成し、 <strong class="command">pip</strong> で読み込ませます。</p>
<div class="highlight-python"><pre>&gt; cd webapp-tools
&gt; notepad requirements.txt        # 下記参照
&gt; Scripts\activate
&gt; pip install -r requirements.txt</pre>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><tt class="file docutils literal"><span class="pre">requirements.txt</span></tt></p>
<div class="last highlight-python"><div class="highlight"><pre><span class="n">Django</span><span class="o">==</span><span class="mf">1.3</span>
</pre></div>
</div>
</div>
<p>これで Django をインストールできました。次の２点を確認しましょう。</p>
<ol class="arabic simple">
<li>Scripts フォルダに <tt class="file docutils literal"><span class="pre">django-admin.py</span></tt> というファイルが追加されていること。</li>
<li>Python インタープリタを起動して、 <em>django</em> モジュールをインポートできること。</li>
</ol>
<div class="highlight-python"><pre>&gt; python Scripts\django-admin.py --version
1.3
&gt; python
&gt;&gt;&gt; import django
&gt;&gt;&gt; django.VERSION
(1, 3, 0, 'final', 0)</pre>
</div>
<p>実装するときは、virtualenv の有効化を忘れないようにしましょう。</p>
</div>
<div class="section" id="id2">
<h2>プロジェクトを作成する<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p><tt class="file docutils literal"><span class="pre">django-admin.py</span></tt> を使ってプロジェクトを作成します。
まずはお遊び用の環境ということで、 <em>sandbox</em> を作りましょう。</p>
<div class="highlight-python"><pre>&gt; python Scripts\django-admin.py startproject sandbox</pre>
</div>
<p><em>sandbox</em> というフォルダが作成されます。次のような Python スクリプトが配置されます。</p>
<div class="highlight-python"><pre>&gt; dir /b sandbox
manage.py
settings.py
urls.py
__init__.py</pre>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Djangoの開発版 (1.4以降) ではプロジェクトのファイルレイアウトが変更されます。
詳しくは公式のチュートリアル (英語) を参照してください。
また、 <tt class="file docutils literal"><span class="pre">wsgi.py</span></tt> というファイルも追加されるでしょう。</p>
</div>
<p>まずは <tt class="file docutils literal"><span class="pre">settings.py</span></tt> を編集します。</p>
<div class="highlight-python"><pre>&gt; cd sandbox
&gt; notepad settings.py        # 下記参照</pre>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>データベースには SQLite を使いますので、 DATABASES の部分を次のように変更します。</p>
<div class="last highlight-python"><div class="highlight"><pre><span class="n">DATABASES</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">&#39;default&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">&#39;ENGINE&#39;</span><span class="p">:</span> <span class="s">&#39;django.db.backends.sqlite3&#39;</span><span class="p">,</span>
        <span class="s">&#39;NAME&#39;</span><span class="p">:</span> <span class="s">&#39;sandbox.sqlite&#39;</span><span class="p">,</span>
        <span class="s">&#39;USER&#39;</span><span class="p">:</span> <span class="s">&#39;&#39;</span><span class="p">,</span>
        <span class="s">&#39;PASSWORD&#39;</span><span class="p">:</span> <span class="s">&#39;&#39;</span><span class="p">,</span>
        <span class="s">&#39;HOST&#39;</span><span class="p">:</span> <span class="s">&#39;&#39;</span><span class="p">,</span>
        <span class="s">&#39;PORT&#39;</span><span class="p">:</span> <span class="s">&#39;&#39;</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<p>次に、Django プロジェクトの管理スクリプト <tt class="file docutils literal"><span class="pre">manage.py</span></tt> を使ってデータベースを作成します。</p>
<div class="highlight-python"><pre>&gt; python manage.py syncdb</pre>
</div>
<p>次の質問には &#8220;yes&#8221; と答え、ユーザー名、メールアドレス、パスワードをそれぞれ入力します。</p>
<blockquote>
<div>Would you like to create one now? (yes/no): yes</div></blockquote>
<p>作業中のフォルダに、先ほど指定したデータベースファイル <tt class="file docutils literal"><span class="pre">sandbox.sqlite</span></tt> が作成されています。</p>
<div class="highlight-python"><pre>&gt; dir /b
manage.py
sandbox.sqlite
settings.py
settings.pyc
urls.py
__init__.py
__init__.pyc</pre>
</div>
</div>
<div class="section" id="id3">
<h2>管理画面を有効にする<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<p>Django には管理画面がアプリケーションとして同梱されています。
最初は有効になっていませんので、それを有効化します。
<tt class="file docutils literal"><span class="pre">settings.py</span></tt> と <tt class="file docutils literal"><span class="pre">urls.py</span></tt> を編集します。</p>
<p><tt class="file docutils literal"><span class="pre">settings.py</span></tt> の下の方にある INSTALLED_APPS で <tt class="docutils literal"><span class="pre">django.contrib.admin</span></tt>  をコメントインします。</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">INSTALLED_APPS</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s">&#39;django.contrib.auth&#39;</span><span class="p">,</span>
    <span class="s">&#39;django.contrib.contenttypes&#39;</span><span class="p">,</span>
    <span class="s">&#39;django.contrib.sessions&#39;</span><span class="p">,</span>
    <span class="s">&#39;django.contrib.sites&#39;</span><span class="p">,</span>
    <span class="s">&#39;django.contrib.messages&#39;</span><span class="p">,</span>
    <span class="s">&#39;django.contrib.staticfiles&#39;</span><span class="p">,</span>
    <span class="c"># Uncomment the next line to enable the admin:</span>
    <span class="s">&#39;django.contrib.admin&#39;</span><span class="p">,</span>
    <span class="c"># Uncomment the next line to enable admin documentation:</span>
    <span class="c"># &#39;django.contrib.admindocs&#39;,</span>
<span class="p">)</span>
</pre></div>
</div>
<p><tt class="file docutils literal"><span class="pre">urls.py</span></tt> を変更します。英語ですが、コメントを読んでください。</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.conf.urls.defaults</span> <span class="kn">import</span> <span class="n">patterns</span><span class="p">,</span> <span class="n">include</span><span class="p">,</span> <span class="n">url</span>

<span class="c"># Uncomment the next two lines to enable the admin:</span>
<span class="kn">from</span> <span class="nn">django.contrib</span> <span class="kn">import</span> <span class="n">admin</span>
<span class="n">admin</span><span class="o">.</span><span class="n">autodiscover</span><span class="p">()</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="n">patterns</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">,</span>
    <span class="c"># Examples:</span>
    <span class="c"># url(r&#39;^$&#39;, &#39;sandbox.views.home&#39;, name=&#39;home&#39;),</span>
    <span class="c"># url(r&#39;^sandbox/&#39;, include(&#39;sandbox.foo.urls&#39;)),</span>

    <span class="c"># Uncomment the admin/doc line below to enable admin documentation:</span>
    <span class="c"># url(r&#39;^admin/doc/&#39;, include(&#39;django.contrib.admindocs.urls&#39;)),</span>

    <span class="c"># Uncomment the next line to enable the admin:</span>
    <span class="n">url</span><span class="p">(</span><span class="s">r&#39;^admin/&#39;</span><span class="p">,</span> <span class="n">include</span><span class="p">(</span><span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">urls</span><span class="p">)),</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="id4">
<h2>テストサーバを起動する<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h2>
<p>Django の管理ツール <tt class="file docutils literal"><span class="pre">manage.py</span></tt> を使ってテストサーバを起動します。</p>
<div class="highlight-python"><pre>&gt; python manage.py runserver
Validating models...

0 errors found
Django version 1.3, using settings 'sandbox.settings'
Development server is running at http://127.0.0.1:8000/
Quit the server with CTRL-BREAK.</pre>
</div>
<p>Web ブラウザで <a class="reference external" href="http://localhost:8000/">8000 番ポート</a> にアクセスすると、 Django のエラー画面が表示されます。</p>
<div class="figure">
<img alt="../images/django-page-not-found.png" src="../images/django-page-not-found.png" />
</div>
<p><a class="reference external" href="http://localhost:8000/admin">/admin/</a> にアクセスすると管理画面が表示されます。</p>
<div class="figure">
<img alt="../images/django-admin-login.png" src="../images/django-admin-login.png" />
</div>
<p>ユーザー名とパスワードは、上述の syncdb のときに入力したものです。</p>
<p>これで Django プロジェクトの作成が完了しました。
Ctrl+BREAK (Linux などの場合は Ctrl+C) でテストサーバを停止できます。
次に開発を再開するときは、virtualenv を有効にしてから <tt class="file docutils literal"><span class="pre">manage.py</span></tt> を使ってテストサーバを起動します。</p>
</div>
</div>


      </div>
      <div class="bottomnav">
      
        <p>
        «&#160;&#160;<a href="index.html">Webアプリケーションの実装</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="../index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="webapps-2.html">アプリケーションの作成</a>&#160;&#160;»
        </p>

      </div>

    <div class="footer">
        &copy; Copyright 2013, KITAZAKI Shigeru.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>