<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>ネットワークプログラミング &mdash; Python School 2.0.0 documentation</title>
    
    <link rel="stylesheet" href="../static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="../static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '2.0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../static/jquery.js"></script>
    <script type="text/javascript" src="../static/underscore.js"></script>
    <script type="text/javascript" src="../static/doctools.js"></script>
    <link rel="top" title="Python School 2.0.0 documentation" href="../index.html" /> 
  </head>
  <body>
      <div class="header"><h1 class="heading"><a href="../index.html">
          <span>Python School 2.0.0 documentation</span></a></h1>
        <h2 class="heading"><span>ネットワークプログラミング</span></h2>
      </div>
      <div class="topnav">
      
        <p>
        <a class="uplink" href="../index.html">Contents</a>
        </p>

      </div>
      <div class="content">
        
        
  <div class="section" id="id1">
<h1>ネットワークプログラミング<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<p>簡単なネットワークプログラミングを行います。</p>
<div class="section" id="http">
<h2>HTTP でダウンロード<a class="headerlink" href="#http" title="Permalink to this headline">¶</a></h2>
<p>標準ライブラリの <cite>urllib</cite> を使います。</p>
<ul class="simple">
<li><a class="reference external" href="http://docs.python.org/library/urllib.html">20.5. urllib — Open arbitrary resources by URL</a> - (公式ドキュメント)</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>似た名称のライブラリとして <cite>httplib</cite> があります。これは使いません。</p>
<p><a class="reference external" href="http://www.python.jp/doc/2.4/lib/module-httplib.html">httplib &#8211; HTTP プロトコルクライアント</a></p>
<blockquote class="last">
<div>通常、このモジュールは直接使いません</div></blockquote>
</div>
<p>引数で渡された URL のコンテンツをダウンロードする処理は次のように記述できます。</p>
<p><tt class="file docutils literal"><span class="pre">downloader.py</span></tt></p>
<p>Linux などの場合は <strong class="command">wget</strong> や <strong class="command">curl</strong> で十分ですが、
Windows 環境でバッチ処理でダウンロードさせたい場合には便利でしょう。</p>
<p>実行結果</p>
<div class="highlight-python"><div class="highlight"><pre>&gt; python downloader.py &quot;http://chart.googleapis.com/chart?chs=250x100&amp;chd=t:60,40&amp;cht=p3&amp;chl=Hello|World&quot;
&gt; move chart hello-world-chart.png
</pre></div>
</div>
<p><tt class="file docutils literal"><span class="pre">hello-world-chart.png</span></tt></p>
<div class="figure">
<img alt="advanced/hello-world-chart.png" src="advanced/hello-world-chart.png" />
</div>
</div>
<div class="section" id="id2">
<h2>HTTP のレスポンス処理<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>単にファイルに書き出すのではなく、読み込んだデータを加工することも多くあります。
大枠は上記のダウンロードスクリプトと同じですが、
追加で標準ライブラリの <cite>urllib2</cite> も使います。</p>
<ul class="simple">
<li><a class="reference external" href="http://docs.python.org/library/urllib2.html">20.6. urllib2 — extensible library for opening URLs</a></li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">標準ライブラリには <tt class="docutils literal"><span class="pre">urllib</span></tt> と <tt class="docutils literal"><span class="pre">urllib2</span></tt> があります。
モジュール名に数字が付いていたり、Python 3 系では統合されていたり、
この辺りの経緯はややこしいので、Python に詳しい人に口頭で確認してください。
このため、ブログ記事などは参照するときは、Python のどのバージョンを対象にしているかを <em>必ず</em> 確認してください。</p>
</div>
<p>Google の API から天気予報を取得します。
結果は XML で返ってきますので、それを解析して表示させます。</p>
<p><tt class="file docutils literal"><span class="pre">http-request-sample.py</span></tt></p>
<p>実行結果</p>
<div class="highlight-python"><div class="highlight"><pre>$ python http-request-sample.py
  Thu   Clear                    30      43
  Fri   Mostly Sunny             30      43
  Sat   Mostly Sunny             28      41
  Sun   Mostly Sunny             28      37
</pre></div>
</div>
<p>曜日、天気予報、最低気温、最高気温が表示されます。
なお、気温は華氏です。</p>
<p><cite>urllib2</cite> を使うときは、環境変数 <em>http_proxy</em> でプロキシサーバを設定できます。
環境変数の確認方法は <a class="reference internal" href="../cmdline/cmdline-3.html"><em>設定情報を読み込む</em></a> を参照してください。
環境変数の設定方法は OS によって異なりますので、そのお作法に従ってください。</p>
<p>プロキシは自前でも設定できます。
公式ドキュメントにサンプルコードが掲載されていますので、一通り眺めてみると良いでしょう。</p>
<p>通信部分を柔軟に扱えるようにしたサードパーティーライブラリもあります。
必要に応じて利用すると便利ですが、様々なマシンで動かすためにはモジュールのポータビリティに注意してください。</p>
<ul class="simple">
<li><a class="reference external" href="http://code.google.com/p/httplib2/">httplib2</a></li>
<li><a class="reference external" href="http://pypi.python.org/pypi/requests">requests</a></li>
</ul>
</div>
</div>


      </div>
      <div class="bottomnav">
      
        <p>
        <a class="uplink" href="../index.html">Contents</a>
        </p>

      </div>

    <div class="footer">
        &copy; Copyright 2014, KITAZAKI Shigeru.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
  </body>
</html>